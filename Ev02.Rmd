---
title: "Análisis de secuencias de ADN de distintos tipos de coronavirus que afectan a diferentes especies con el fin de explicar la zoonosis del virus."
author: "Yael G"
date: "2024-02-05"
output: html_document
---

Para comprender la zoonosis del virus, es necesario analizar las secuencias de ADN de varios tipos de coronavirus que afectan a diferentes especies. La zoonosis es la transmisión de patógenos de animales a humanos, un fenómeno crítico para comprender y prevenir enfermedades emergentes. Este análisis puede ayudar a prevenir y desarrollar métodos efectivos para controlar y tratar pandemias en el futuro.


```{r}
library(seqinr)
library(stringr)
library(Biostrings)
library(formattable)
library (scales)
library(adegenet)
library(ape)
library(ggtree)
library(DECIPHER)
library(viridis)
library(ggplot2)
library(ggmsa)

leer <- function(archivo) {
  secuencia <- readDNAStringSet(archivo)[[1]]
  secuencia_caracter <- as.character(secuencia)
  return(secuencia_caracter)
}

tamaño_secuencia<-function(txt){
  tamaño <- nchar(txt)
  return(tamaño)
}

nucl <- function(txt, c) {
  cant <- sum(unlist(strsplit(txt, "")) == c)
  porcentaje <- (cant / tamaño_secuencia(txt)) * 100
  return(porcentaje)
}



Archivos <- c("humano.fasta","camello.fasta", "cerdo.fasta", "conejo.fasta", 
              "delfin.fasta","erizo.fasta", "gallineta_ave.fasta", 
              "garza_noct_ave.fasta","llamas.fasta", "lonchura_ave.fasta", 
              "mareca_ave.fasta", "murcielago.fasta", "musaraña.fasta", 
              "palm_civet.fasta", "rata_gris.fasta", "raton_campo.fasta", 
              "tigre_sars.fasta", "turon.fasta", "vison_ame.fasta", 
              "zorzal_gris_ave.fasta", "zoste_ave.fasta")

Nombres <- c("Humano","Camello", "Cerdo", "Conejo", "Delfín", "Erizo", "Gallineta", 
             "Garza", "Llama", "Lonchura", "Mareca", "Murcielago", "Musaraña", 
             "Civeta", "Rata", "Ratón", "Tigre", "Turón", "Visón", "Zorzal", 
             "Zosteropidae")

nucleotidos <- c('A', 'C', 'G', 'T')

m <- length (Archivos)
tamaño <- matrix (ncol = 1, nrow = m)
bases <- matrix (ncol = m, nrow = 4)
pro_gra <- list ()

for (i in 1:m){
  secuencia <- leer(Archivos [i])
  j <- 1
  for (elemento in nucleotidos){
    bases[j,i] <- nucl (secuencia, elemento)
    j <- j + 1
  }
  tamaño [i, 1] <- formatC (tamaño_secuencia (secuencia), digits = 2, 
                            format = "d", big.mark = ",")
}



datos <- data.frame ("Host" = Nombres, "Tamaño de la secuencia" = tamaño, 
                     "% de Adenina" = bases[1,], "% de Citosina" = bases[2,], 
                     "% de Guanina" = bases[3,], "% de Timina" = bases [4,],
                     check.names = FALSE)
formattable(datos, align = c("l", rep("r", ncol(datos) - 1)))

```
En la tabla anterior se puede observar la longitud de cada secuencia de ADN y los porcentajes de las bases de las variantes de coronavirus que afectan a diferentes organismos. 



```{r}

colores <- c("#FAEBD7", "#8B8378", "#66CDAA", "#F0FFFF")

barplot(bases, ylab = "Nucleotidos", legend.text = rownames(bases), 
        names.arg = Nombres, las = 2, width = 0.01, col = colores)

legend("topright", legend = nucleotidos, fill = colores, title = "Nucleótidos",
       inset = c(0, 0), xpd = TRUE)


```

Tras haber analizado la tabla y la grafica anterior, se logró identificar que de las 20 distintas variantes de coronavirus que afectan a distintos organismos, la gran mayoría cuenta con un mayor porcentaje de timina a comparación del resto, a continuación le sigue la adenina, la guanina y la citosina es aquella que ha demostrado una menor cantidad. 
Sin embargo, hay 4 excepciones con las secuencias de la garza, la llama, la lonchura y el zosteropidae. La garza es la única que tiene mayor adenina a comparación del resto, por consiguiente le sigue la timina, la citosina y por último, la guanina. 

```{r}
filo <- matrix(ncol = 1, nrow = m)
for (i in 1:m){
  filo [i,1] <- leer(Archivos[i])
}
str(filo)
attributes(filo)
names(filo) <- Nombres
attr(filo, "species")

write.dna(filo,  file ="virus_seqs.fasta", format = "fasta", 
          append = FALSE, nbcol = 6, colsep = " ", colw = 10)

virus_seq_no_alineadas <- readDNAStringSet("virus_seqs.fasta", format = "fasta")

virus_seq_no_alineadas <- OrientNucleotides(virus_seq_no_alineadas)

virus_align_seqs <- AlignSeqs(virus_seq_no_alineadas)
BrowseSeqs(virus_align_seqs, highlight=0)
writeXStringSet(virus_align_seqs, file = "virus_align_seq.fasta")
virus_aligned <- read.alignment("virus_align_seq.fasta", format = "fasta") 
matriz_distancia <- dist.alignment(virus_aligned, matrix = "similarity")
virus_filogenetico <- njs(matriz_distancia)
class(virus_filogenetico)
virus_plot_filogenetico <- ladderize(virus_filogenetico)
plot(virus_plot_filogenetico, cex = 0.6)
title("Coronavirus en distintas especies")

```

```{r}
Datos_arbol <- data.frame ("Números" = 1:21, "Host de la secuencia" = Nombres, check.names = FALSE)
formattable (Datos_arbol, align = c("l", rep("r", ncol(datos) - 1))
)

```

El uso de un árbol filogenético con secuencias de ADN permite visualizar las relaciones evolutivas entre virus basadas en similitudes genéticas. 

Analizando el anterior árbol filogenético y basándonos en el ser humano, que en este caso es quien se ve afectado por el SARS_CoV_2, destaca que tiene muchas similitudes con la musaraña, el ratón y la civeta, todos animales mamíferos.  Por otro lado, las aves son aquellos animales que aunque también puedan portar coronavirus, no tiene tantas similitudes cómo lo son los animales anteriormente mencionados. 

En conclusión, tras haber realizado los análisis correspondientes se ha llegado a la conclusión que el SARS_CoV_2 tiene mayores similitudes con los coronavirus que afectan directamente a la musaraña, ratón y la civeta. Basándonos en los resultados, podemos plantear la siguiente hipótesis, Se cree que la musaraña, el ratón y la civeta comparten la mayor similitud genética con el SARS-CoV-2, por lo que podrían haber desempeñado un papel crucial como hospedadores intermediarios en la transmisión del virus a los humanos. Esto podría mejorar nuestra comprensión de la zoonosis y los posibles puntos de origen y transmisión del SARS-CoV-2.



*Video de complemento*
https://youtu.be/e3pNKe-a70Q
